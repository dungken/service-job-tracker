<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H·ªá th·ªëng Qu·∫£n l√Ω Phi·∫øu C√¥ng vi·ªác</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="container">
        <!-- HEADER -->
        <header>
            <h1>üé´ H·ªá th·ªëng Qu·∫£n l√Ω Phi·∫øu C√¥ng vi·ªác</h1>
            <p>Qu·∫£n l√Ω c√¥ng vi·ªác d·ªãch v·ª• v√† b·∫£o tr√¨ hi·ªáu qu·∫£</p>
        </header>

        <!-- MAIN CONTENT -->
        <section class="main-content">
            <h2>Qu·∫£n l√Ω Phi·∫øu C√¥ng vi·ªác</h2>

            <!-- Statistics -->
            <div class="stats-grid">
                <div class="stat-card">
                    <h3 id="statTotal">0</h3>
                    <p>T·ªïng s·ªë phi·∫øu</p>
                </div>
                <div class="stat-card orange">
                    <h3 id="statWaiting">0</h3>
                    <p>Ch·ªù x·ª≠ l√Ω</p>
                </div>
                <div class="stat-card blue">
                    <h3 id="statInProgress">0</h3>
                    <p>ƒêang x·ª≠ l√Ω</p>
                </div>
                <div class="stat-card green">
                    <h3 id="statCompleted">0</h3>
                    <p>ƒê√£ ho√†n th√†nh</p>
                </div>
                <div class="stat-card">
                    <h3 id="statRevenue">0ƒë</h3>
                    <p>T·ªïng doanh thu</p>
                </div>
            </div>

            <!-- Filters -->
            <h3 style="margin-top: 30px; margin-bottom: 15px; font-size: 18px; color: #333;">Danh s√°ch Phi·∫øu</h3>
            <div class="filters">
                <div class="filters-row">
                    <div class="filter-group">
                        <label>üîç T√¨m ki·∫øm</label>
                        <input type="text" id="adminSearchQuery" placeholder="T√™n ho·∫∑c SƒêT..." onkeyup="renderTicketList()">
                    </div>
                    <div class="filter-group">
                        <label>Tr·∫°ng th√°i</label>
                        <select id="adminStatusFilter" onchange="renderTicketList()">
                            <option value="all">T·∫•t c·∫£</option>
                            <option value="Waiting">Ch·ªù x·ª≠ l√Ω</option>
                            <option value="In Progress">ƒêang x·ª≠ l√Ω</option>
                            <option value="Completed">ƒê√£ ho√†n th√†nh</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>KTV</label>
                        <select id="adminKTVFilter" onchange="renderTicketList()">
                            <option value="all">T·∫•t c·∫£</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>T·ª´ ng√†y</label>
                        <input type="date" id="adminDateFrom" onchange="renderTicketList()">
                    </div>
                    <div class="filter-group">
                        <label>ƒê·∫øn ng√†y</label>
                        <input type="date" id="adminDateTo" onchange="renderTicketList()">
                    </div>
                </div>
            </div>

            <!-- Table -->
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>M√£ phi·∫øu</th>
                            <th>Kh√°ch h√†ng</th>
                            <th>SƒêT</th>
                            <th>ƒê·ªãa ch·ªâ</th>
                            <th>M√¥ t·∫£</th>
                            <th>Tr·∫°ng th√°i</th>
                            <th>KTV</th>
                            <th>Th·ªùi gian t·∫°o</th>
                            <th>Ho√†n th√†nh</th>
                            <th>Ph√≠ (VNƒê)</th>
                            <th>Thao t√°c</th>
                        </tr>
                    </thead>
                    <tbody id="adminTableBody"></tbody>
                </table>
            </div>

            <!-- Backup Section -->
            <h3 style="margin-top: 40px; margin-bottom: 15px; font-size: 18px; color: #333;">Sao l∆∞u & Kh√¥i ph·ª•c</h3>

            <!-- Important Notice -->
            <div class="storage-notice">
                <h3>üìå L∆∞u √Ω quan tr·ªçng v·ªÅ l∆∞u tr·ªØ d·ªØ li·ªáu</h3>
                <div class="notice-content">
                    <div class="notice-item">
                        <span class="notice-icon">‚è∞</span>
                        <div class="notice-text">
                            <strong>Th·ªùi gian l∆∞u tr·ªØ:</strong>
                            <p>D·ªØ li·ªáu ƒë∆∞·ª£c l∆∞u <strong>vƒ©nh vi·ªÖn</strong> tr√™n tr√¨nh duy·ªát (localStorage) cho ƒë·∫øn khi b·∫°n x√≥a cache/d·ªØ li·ªáu tr√¨nh duy·ªát ho·∫∑c x√≥a th·ªß c√¥ng trong ·ª©ng d·ª•ng.</p>
                        </div>
                    </div>
                    <div class="notice-item">
                        <span class="notice-icon">üíæ</span>
                        <div class="notice-text">
                            <strong>Gi·ªõi h·∫°n dung l∆∞·ª£ng:</strong>
                            <p>Tr√¨nh duy·ªát gi·ªõi h·∫°n <strong>5-10 MB</strong> cho m·ªói website. V·ªõi h√¨nh ·∫£nh base64, b·∫°n c√≥ th·ªÉ l∆∞u kho·∫£ng <strong>20-100 phi·∫øu c√≥ ·∫£nh</strong>.</p>
                        </div>
                    </div>
                    <div class="notice-item">
                        <span class="notice-icon">‚ö†Ô∏è</span>
                        <div class="notice-text">
                            <strong>Khuy·∫øn ngh·ªã:</strong>
                            <p>N√™n <strong>sao l∆∞u d·ªØ li·ªáu ƒë·ªãnh k·ª≥</strong> (xu·∫•t file JSON) ƒë·ªÉ tr√°nh m·∫•t d·ªØ li·ªáu khi x√≥a cache ho·∫∑c ƒë·ªïi thi·∫øt b·ªã.</p>
                        </div>
                    </div>
                    <div class="notice-item">
                        <span class="notice-icon">üîí</span>
                        <div class="notice-text">
                            <strong>B·∫£o m·∫≠t:</strong>
                            <p>D·ªØ li·ªáu ch·ªâ l∆∞u tr√™n <strong>tr√¨nh duy·ªát c·ªßa b·∫°n</strong>, kh√¥ng ƒë∆∞·ª£c ƒë·ªìng b·ªô l√™n server. M·ªói tr√¨nh duy·ªát/thi·∫øt b·ªã c√≥ d·ªØ li·ªáu ri√™ng.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label>Xu·∫•t d·ªØ li·ªáu</label>
                <p style="color: #666; font-size: 14px; margin-bottom: 10px;">
                    T·∫£i xu·ªëng t·∫•t c·∫£ d·ªØ li·ªáu phi·∫øu c√¥ng vi·ªác d∆∞·ªõi d·∫°ng file JSON ƒë·ªÉ sao l∆∞u ho·∫∑c chuy·ªÉn sang thi·∫øt b·ªã kh√°c.
                </p>
                <button class="btn btn-info" onclick="exportData()">
                    üì• Xu·∫•t d·ªØ li·ªáu (JSON)
                </button>
            </div>

            <div class="form-group mt-20">
                <label>Nh·∫≠p d·ªØ li·ªáu</label>
                <p style="color: #666; font-size: 14px; margin-bottom: 10px;">
                    Kh√¥i ph·ª•c d·ªØ li·ªáu t·ª´ file JSON ƒë√£ xu·∫•t. <strong style="color: #dc3545;">L∆∞u √Ω:</strong> Thao t√°c n√†y s·∫Ω ghi ƒë√® l√™n t·∫•t c·∫£ d·ªØ li·ªáu hi·ªán t·∫°i.
                </p>
                <div class="file-input-wrapper">
                    <input type="file" id="importFile" accept=".json" onchange="importData(event)">
                    <label for="importFile" class="file-input-label">
                        <span>üì§</span>
                        <span>Ch·ªçn file JSON</span>
                    </label>
                </div>
            </div>

            <div class="form-group mt-20">
                <label>X√≥a t·∫•t c·∫£ d·ªØ li·ªáu</label>
                <p style="color: #666; font-size: 14px; margin-bottom: 10px;">
                    <strong style="color: #dc3545;">C·∫£nh b√°o:</strong> Thao t√°c n√†y s·∫Ω x√≥a vƒ©nh vi·ªÖn t·∫•t c·∫£ d·ªØ li·ªáu. H√£y ch·∫Øc ch·∫Øn b·∫°n ƒë√£ sao l∆∞u tr∆∞·ªõc khi th·ª±c hi·ªán.
                </p>
                <button class="btn btn-danger" onclick="clearAllData()">
                    üóëÔ∏è X√≥a t·∫•t c·∫£ d·ªØ li·ªáu
                </button>
            </div>

            <div class="form-group mt-20">
                <label>Th√¥ng tin l∆∞u tr·ªØ</label>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                    <p style="margin-bottom: 8px;"><strong>Phi√™n b·∫£n schema:</strong> <span id="schemaVersion">-</span></p>
                    <p style="margin-bottom: 8px;"><strong>T·ªïng s·ªë phi·∫øu:</strong> <span id="totalTicketsInfo">-</span></p>
                    <p style="margin-bottom: 0;"><strong>Dung l∆∞·ª£ng s·ª≠ d·ª•ng:</strong> <span id="storageSize">-</span></p>
                </div>
            </div>
        </section>
    </div>

    <!-- FLOATING ADD BUTTON -->
    <button class="fab" onclick="openCreateTicketModal()" title="T·∫°o phi·∫øu m·ªõi">
        <span class="fab-icon">+</span>
    </button>

    <!-- CREATE TICKET MODAL -->
    <div id="createTicketModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>T·∫°o Phi·∫øu C√¥ng vi·ªác M·ªõi</h3>
                <button class="modal-close" onclick="closeCreateModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="createTicketForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label>T√™n kh√°ch h√†ng <span style="color: red;">*</span></label>
                            <input type="text" id="customerName" placeholder="V√≠ d·ª•: Anh A, Ch·ªã B" required>
                        </div>
                        <div class="form-group">
                            <label>S·ªë ƒëi·ªán tho·∫°i <span style="color: red;">*</span></label>
                            <input type="tel" id="customerPhone" placeholder="V√≠ d·ª•: 0909123456" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>ƒê·ªãa ch·ªâ (T√πy ch·ªçn)</label>
                        <input type="text" id="customerAddress" placeholder="V√≠ d·ª•: Ph√≤ng 302, T√≤a A">
                    </div>

                    <div class="form-group">
                        <label>M√¥ t·∫£ v·∫•n ƒë·ªÅ <span style="color: red;">*</span></label>
                        <textarea id="issueDescription" placeholder="V√≠ d·ª•: M√°y l·∫°nh kh√¥ng m√°t, ƒëi·ªÅu h√≤a kh√¥ng ho·∫°t ƒë·ªông..." required></textarea>
                    </div>

                    <div class="form-group">
                        <label>H√¨nh ·∫£nh (T√πy ch·ªçn)</label>
                        <div class="file-input-wrapper">
                            <input type="file" id="ticketImages" accept="image/*" multiple>
                            <label for="ticketImages" class="file-input-label">
                                <span>üì∑</span>
                                <span>Ch·ªçn h√¨nh ·∫£nh</span>
                            </label>
                        </div>
                        <div id="imagePreviewContainer" class="image-preview-container"></div>
                    </div>

                    <div class="modal-footer">
                        <button type="submit" class="btn btn-primary">‚úì T·∫°o Phi·∫øu</button>
                        <button type="button" class="btn btn-danger" onclick="closeCreateModal()">H·ªßy</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- TICKET DETAIL MODAL -->
    <div id="ticketModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Chi ti·∫øt Phi·∫øu</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div id="modalBody"></div>
            </div>
            <div class="modal-footer" id="modalFooter"></div>
        </div>
    </div>

    <!-- JAVASCRIPT -->
    <script src="app.js"></script>
</body>

</html>
